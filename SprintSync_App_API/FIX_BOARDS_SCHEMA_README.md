# Fix Boards Schema - Database Migration

This script fixes the missing `boards` table and `board_id` column issues in the database.

## Problem
The application was encountering errors:
- `ERROR: relation "boards" does not exist`
- `ERROR: column wl1_0.board_id does not exist`

## Solution
This migration script:
1. Creates the `boards` table if it doesn't exist
2. Adds the `board_id` column to `workflow_lanes` table if it doesn't exist
3. Sets up proper foreign key constraints
4. Creates necessary indexes for performance
5. Updates unique constraints to handle board-specific lanes

## How to Run

### Option 1: Using PowerShell Script (Recommended for Windows)
```powershell
cd SprintSync_App_API
.\fix-boards-schema.ps1
```

### Option 2: Using psql Command Line
```powershell
$env:PGPASSWORD = "AVNS_Dte-khF5WTLnyXPYp_q"
psql -h sprintsync-sanikasapkale20-58f9.b.aivencloud.com -p 19973 -U avnadmin -d defaultdb -f fix-boards-schema.sql
```

### Option 3: Using pgAdmin or Any PostgreSQL Client
1. Open pgAdmin or your preferred PostgreSQL client
2. Connect to your database
3. Open and execute the `fix-boards-schema.sql` file

## Verification

After running the script, verify the changes:

```sql
-- Check if boards table exists
SELECT table_name FROM information_schema.tables WHERE table_name = 'boards';

-- Check if board_id column exists in workflow_lanes
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'workflow_lanes' AND column_name = 'board_id';

-- Check indexes
SELECT indexname FROM pg_indexes WHERE tablename IN ('boards', 'workflow_lanes');
```

## Notes

- The script uses `IF NOT EXISTS` and `DO $$` blocks to safely handle cases where tables/columns already exist
- The script is idempotent - you can run it multiple times safely
- Board IDs are generated by the application using UUID, not by the database
- The `board_id` column in `workflow_lanes` is nullable - NULL means the lane belongs to the default board

## After Running

Restart your Spring Boot application to ensure it picks up the new schema changes.

